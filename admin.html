<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <title>Admin - Archive Metadata ‚Äì Magn√∫s P√°lsson</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <style>
    .metadata-section {
      margin: 2rem 0;
      padding: 1rem;
      background: rgba(0,0,0,0.02);
      border-radius: 8px;
    }
    .work-entry {
      margin: 1rem 0;
      padding: 1rem;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    .work-images {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin: 1rem 0;
    }
    .work-images img {
      max-width: 100px;
      max-height: 100px;
      object-fit: cover;
    }
    pre {
      background: #f4f4f4;
      padding: 1rem;
      overflow-x: auto;
      font-size: 0.85rem;
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 2rem 0;
    }
    .stat-card {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .file-list {
      font-family: monospace;
      font-size: 0.9rem;
    }
    .tag {
      display: inline-block;
      padding: 0.2rem 0.5rem;
      background: #e0e0e0;
      border-radius: 3px;
      margin: 0.2rem;
      font-size: 0.85rem;
    }
  </style>
</head>
<body>

  <!-- Navigation placeholder -->
  <div id="nav-placeholder"></div>

  <main class="container">
    <h1>Archive Admin & Metadata</h1>
    
    <!-- Statistics -->
    <div class="stats" id="stats">
      <div class="stat-card">
        <h3>Total Works</h3>
        <p id="total-works">Loading...</p>
      </div>
      <div class="stat-card">
        <h3>Total Images</h3>
        <p id="total-images">Loading...</p>
      </div>
      <div class="stat-card">
        <h3>Total Exhibitions</h3>
        <p id="total-exhibitions">Loading...</p>
      </div>
      <div class="stat-card">
        <h3>Year Range</h3>
        <p id="year-range">Loading...</p>
      </div>
    </div>

    <!-- Workflow Status -->
    <section class="metadata-section">
      <h2>üö¶ Workflow Status</h2>
      <div class="stats">
        <div class="stat-card">
          <h4>Content Status</h4>
          <p><strong id="content-needs-review">0</strong> needs review</p>
          <p><strong id="content-draft">0</strong> draft</p>
        </div>
        <div class="stat-card">
          <h4>Media Status</h4>
          <p><strong id="media-done">0</strong> done</p>
          <p><strong id="media-review">0</strong> review</p>
          <p><strong id="media-draft">0</strong> draft</p>
        </div>
      </div>
      <details>
        <summary>View Works Needing Attention</summary>
        <div style="margin-top: 1rem;">
          <h4>Content Ready for Review:</h4>
          <div id="content-review-list" style="margin: 1rem 0; font-size: 0.9rem;"></div>
          <h4>Images Ready for Review:</h4>
          <div id="media-review-list" style="margin: 1rem 0; font-size: 0.9rem;"></div>
        </div>
      </details>
    </section>

    <!-- Assistant Workflow Documents -->
    <section class="metadata-section">
      <h2>üìã Assistant Workflow Documents</h2>
      <p><strong>For adding ~160 artworks from Dropbox folders</strong></p>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 1rem 0;">
        <div class="stat-card">
          <h4>üìñ Main Workflow</h4>
          <p>Complete step-by-step process</p>
          <a href="WORKFLOW_FOR_ASSISTANT.md" target="_blank" style="font-weight: bold;">WORKFLOW_FOR_ASSISTANT.md</a>
        </div>
        <div class="stat-card">
          <h4>üìù Work Template</h4>
          <p>Copy/paste JSON template</p>
          <a href="WORK_TEMPLATE.json" target="_blank" style="font-weight: bold;">WORK_TEMPLATE.json</a>
        </div>
        <div class="stat-card">
          <h4>üñºÔ∏è Image Processing</h4>
          <p>Resize, compress, optimize</p>
          <a href="IMAGE_PROCESSING_GUIDE.md" target="_blank" style="font-weight: bold;">IMAGE_PROCESSING_GUIDE.md</a>
        </div>
        <div class="stat-card">
          <h4>üé¨ Video Processing</h4>
          <p>Compress, web optimization</p>
          <a href="VIDEO_PROCESSING_GUIDE.md" target="_blank" style="font-weight: bold;">VIDEO_PROCESSING_GUIDE.md</a>
        </div>
      </div>
      <div style="background: #f8f9fa; padding: 1rem; border-radius: 4px; margin: 1rem 0;">
        <strong>Quick Start:</strong> Begin with WORKFLOW_FOR_ASSISTANT.md ‚Üí process 2-3 test works ‚Üí use templates ‚Üí scale up to batch processing
      </div>
    </section>

    <!-- Archive Standards -->
    <section class="metadata-section">
      <h2>Archive Standards</h2>
      <details>
        <summary>View Standards Document</summary>
        <pre id="standards-content">Loading...</pre>
      </details>
    </section>

    <!-- Works Data -->
    <section class="metadata-section">
      <h2>Works Database</h2>
      <details>
        <summary>View Raw JSON</summary>
        <pre id="works-json">Loading...</pre>
      </details>
      
      <h3>Works Overview</h3>
      <div id="works-list"></div>
    </section>

    <!-- Search Index -->
    <section class="metadata-section">
      <h2>Search Index</h2>
      <details>
        <summary>View Search Index</summary>
        <pre id="search-json">Loading...</pre>
      </details>
    </section>

    <!-- File Structure -->
    <section class="metadata-section">
      <h2>Image Files Status</h2>
      <div id="file-status"></div>
    </section>
  </main>

  <!-- Footer placeholder -->
  <div id="footer-placeholder"></div>

  <!-- Scripts -->
  <script src="nav.js"></script>
  <script src="footer.js"></script>
  <script>
    async function loadAdminData() {
      try {
        // Load works data
        const worksResponse = await fetch('works.json');
        const worksData = await worksResponse.json();
        
        // Display statistics
        document.getElementById('total-works').textContent = worksData.works.length;

        let totalImages = 0;
        let years = [];
        let contentNeedsReview = [];
        let contentDraft = 0;
        let mediaDone = 0;
        let mediaReview = [];
        let mediaDraft = 0;

        worksData.works.forEach(work => {
          totalImages += work.images.length;
          years.push(work.year);

          // Count content status
          if (work.contentStatus === 'needs review') {
            contentNeedsReview.push(work);
          } else if (work.contentStatus === 'draft') {
            contentDraft++;
          }

          // Count media status
          if (work.mediaStatus === 'images done') {
            mediaDone++;
          } else if (work.mediaStatus === 'images review') {
            mediaReview.push(work);
          } else if (work.mediaStatus === 'images draft') {
            mediaDraft++;
          }
        });

        document.getElementById('total-images').textContent = totalImages;

        // Display workflow status
        document.getElementById('content-needs-review').textContent = contentNeedsReview.length;
        document.getElementById('content-draft').textContent = contentDraft;
        document.getElementById('media-done').textContent = mediaDone;
        document.getElementById('media-review').textContent = mediaReview.length;
        document.getElementById('media-draft').textContent = mediaDraft;

        // Display works needing review
        const contentReviewList = document.getElementById('content-review-list');
        if (contentNeedsReview.length === 0) {
          contentReviewList.innerHTML = '<p style="color: #999;">No works pending content review</p>';
        } else {
          contentReviewList.innerHTML = contentNeedsReview.map(work => {
            const titleText = typeof work.title === 'object' ? work.title.en : work.title;
            return `<div style="padding: 0.5rem; border-left: 3px solid #4CAF50; margin: 0.5rem 0; background: #f9f9f9;">
              <strong>${titleText}</strong> (${work.year}) - <span style="color: #666;">media: ${work.mediaStatus}</span>
            </div>`;
          }).join('');
        }

        const mediaReviewList = document.getElementById('media-review-list');
        if (mediaReview.length === 0) {
          mediaReviewList.innerHTML = '<p style="color: #999;">No works pending media review</p>';
        } else {
          mediaReviewList.innerHTML = mediaReview.map(work => {
            const titleText = typeof work.title === 'object' ? work.title.en : work.title;
            return `<div style="padding: 0.5rem; border-left: 3px solid #2196F3; margin: 0.5rem 0; background: #f9f9f9;">
              <strong>${titleText}</strong> (${work.year}) - <span style="color: #666;">content: ${work.contentStatus}</span>
            </div>`;
          }).join('');
        }
        
        const minYear = Math.min(...years);
        const maxYear = Math.max(...years);
        document.getElementById('year-range').textContent = `${minYear} - ${maxYear}`;
        
        // Count exhibitions
        let exhibitions = new Set();
        worksData.works.forEach(work => {
          work.exhibitions.forEach(ex => {
            exhibitions.add(`${ex.title}-${ex.year}`);
          });
        });
        document.getElementById('total-exhibitions').textContent = exhibitions.size;
        
        // Display raw JSON
        document.getElementById('works-json').textContent = JSON.stringify(worksData, null, 2);
        
        // Display works list
        const worksList = document.getElementById('works-list');
        worksList.innerHTML = worksData.works.map(work => {
          const titleText = typeof work.title === 'object' ? work.title.en : work.title;
          const contentStatusColor = work.contentStatus === 'needs review' ? '#4CAF50' : '#999';
          const mediaStatusColor = work.mediaStatus === 'images done' ? '#4CAF50' :
                                   work.mediaStatus === 'images review' ? '#2196F3' : '#999';
          return `
          <div class="work-entry">
            <h4>${titleText} (${work.year})</h4>
            <p><strong>ID:</strong> ${work.id}</p>
            <p>
              <strong>Content:</strong> <span style="color: ${contentStatusColor}; font-weight: bold;">${work.contentStatus || 'unknown'}</span> |
              <strong>Media:</strong> <span style="color: ${mediaStatusColor}; font-weight: bold;">${work.mediaStatus || 'unknown'}</span>
            </p>
            <p><strong>Images:</strong> ${work.images.length} files</p>
            <div class="work-images">
              ${work.images.slice(0, 3).map(img => 
                img.url.endsWith('.mp3') || img.url.endsWith('.mp4') || img.url.endsWith('.pdf') ?
                `<div style="width:100px;height:100px;background:#f0f0f0;display:flex;align-items:center;justify-content:center;font-size:0.8rem;">${img.url.split('.').pop().toUpperCase()}</div>` :
                `<img src="${img.url}" alt="${work.title}" onerror="this.style.display='none'">`
              ).join('')}
              ${work.images.length > 3 ? `<div style="width:100px;height:100px;display:flex;align-items:center;justify-content:center;">+${work.images.length - 3} more</div>` : ''}
            </div>
            <div class="tags">
              ${work.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
            </div>
            <details>
              <summary>View Full Data</summary>
              <pre>${JSON.stringify(work, null, 2)}</pre>
            </details>
          </div>
        `;
        }).join('');
        
        // Load search index
        const searchResponse = await fetch('search-index.json');
        const searchData = await searchResponse.json();
        document.getElementById('search-json').textContent = JSON.stringify(searchData, null, 2);
        
      } catch (error) {
        console.error('Error loading admin data:', error);
      }
    }
    
    // Load data when page loads
    document.addEventListener('DOMContentLoaded', loadAdminData);
  </script>
</body>
</html>